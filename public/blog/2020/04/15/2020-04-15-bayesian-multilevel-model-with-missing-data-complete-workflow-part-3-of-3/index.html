<!DOCTYPE html>
<html lang="en-us">

  <head>
  <meta charset="utf-8">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <title>Bayesian Multilevel Model with Missing Data Complete Workflow (Part 3 of 3)</title>
  <meta name="author" content="" />
  
  
  
  
  <meta name="keywords" content="R, R programming, Data Science, Statistics, Bayesian, Missing Data, Stan">
  
  
  <meta name="description" content="Musings on R, Statistics, Data Science, and Programming">

  <meta name="generator" content="Hugo 0.69.0" />

  
  <link href='//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,500,700,800' rel='stylesheet' type='text/css'>

  
  <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.11.2/css/all.css">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  
  <link href="/css/animate.css" rel="stylesheet">

  
  
    <link href="/css/style.blue.css" rel="stylesheet" id="theme-stylesheet">
  

  
  <link href="/css/custom.css" rel="stylesheet">

  
  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png" />

  
  <link href="/css/owl.carousel.css" rel="stylesheet">
  <link href="/css/owl.theme.css" rel="stylesheet">

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Dead Reckoning Analytics and Consulting">

  
  
  
  
  
  
  
  <meta property="og:locale" content="en_us">
  <meta property="og:site_name" content="Dead Reckoning Analytics and Consulting">
  <meta property="og:title" content="Bayesian Multilevel Model with Missing Data Complete Workflow (Part 3 of 3)">
  <meta property="og:type" content="article">
  <meta property="og:url" content="/blog/2020/04/15/2020-04-15-bayesian-multilevel-model-with-missing-data-complete-workflow-part-3-of-3/" />
  <meta property="og:description" content="Musings on R, Statistics, Data Science, and Programming">
  <meta property="og:image" content="/img/favicon-dead-1_thumb_20.png">
  <meta property="og:image:type" content="image/png">
  
  
  
    <meta property="og:image:width" content="11">
    <meta property="og:image:height" content="11">
  
  
  <meta property="og:updated_time" content="2020-04-15T00:00:00Z">
  
    
    
    <meta property="article:section" content="Modeling">
    <meta property="article:tag" content="Bayesian">
    <meta property="article:tag" content="Missing Data">
    <meta property="article:tag" content="Stan">
    
    
    <meta property="article:published_time" content="2020-04-15T00:00:00Z">
    <meta property="article:modified_time" content="2020-04-15T00:00:00Z">
  

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@dead_reck">
  <meta name="twitter:title" content="Bayesian Multilevel Model with Missing Data Complete Workflow (Part 3 â€¦">
  
  <meta name="twitter:image" content="/img/favicon-dead-1_thumb_20.png">
  
  <meta name="twitter:description" content="Musings on R, Statistics, Data Science, and Programming">
  
  
  
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX&#45;AMS&#45;MML_HTMLorMML" type="text/javascript"></script>
  <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}}); </script>

</head>


  <body>

    <div id="all">

        <header>

          <div class="navbar-affixed-top" data-spy="affix" data-offset-top="200">

    <div class="navbar navbar-default yamm" role="navigation" id="navbar">

        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand home" href="/">
                    <img src="/img/logo-dead-8.png" height="49" width="241" alt="Bayesian Multilevel Model with Missing Data Complete Workflow (Part 3 of 3) logo" class="hidden-xs hidden-sm">
                    <img src="/img/logo-dead-8.png" height="49" width="241" alt="Bayesian Multilevel Model with Missing Data Complete Workflow (Part 3 of 3) logo" class="visible-xs visible-sm">
                    <span class="sr-only">Bayesian Multilevel Model with Missing Data Complete Workflow (Part 3 of 3) - go to homepage</span>
                </a>
                <div class="navbar-buttons">
                    <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse" data-target="#navigation">
                      <span class="sr-only">Toggle Navigation</span>
                        <i class="fas fa-align-justify"></i>
                    </button>
                </div>
            </div>
            

            <div class="navbar-collapse collapse" id="navigation">
                <ul class="nav navbar-nav navbar-right">
                  
                  
                  
                  <li class="dropdown">
                    
                    <a href="/">Home</a>
                    
                  </li>
                  
                  
                  <li class="dropdown active">
                    
                    <a href="/blog/">Blog</a>
                    
                  </li>
                  
                  
                  <li class="dropdown">
                    
                    <a href="/contact/">Contact</a>
                    
                  </li>
                  
                </ul>
            </div>
            

            <div class="collapse clearfix" id="search">

                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search">
                        <span class="input-group-btn">

                    <button type="submit" class="btn btn-template-main"><i class="fas fa-search"></i></button>

                </span>
                    </div>
                </form>

            </div>
            

        </div>
    </div>
    

</div>




        </header>

        <div id="heading-breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h1>Bayesian Multilevel Model with Missing Data Complete Workflow (Part 3 of 3)</h1>
            </div>
        </div>
    </div>
</div>


        <div id="content">
            <div class="container">

                <div class="row">

                    

                    <div class="col-md-9" id="blog-post">

                        
                          <p class="text-muted text-uppercase mb-small text-right">
                            
                            
                            April 15, 2020
                          </p>
                        

                        <div id="post-content">
                          <h1 id="overview">Overview:</h1>
<p>This is the third post in a three-part blog series I put together. You can find part 1 <a href="../../../../../blog/2018/07/05/2018-07-05-bayesian-multilevel-model-with-missing-data-complete-work-flow/">here</a> and part 2 is <a href="../../../../../blog/2018/07/05/2018-07-05-bayesian-multilevel-model-with-missing-data-complete-work-flow/">here</a>. Part 1 provies a quick overview of exploring missing data properties and sets the table for creating a simple missingness model. Part 2, covers the creation of an imputation model and explores the output of that model. This third post will walkthrough running the analysis using <code>brms</code> (CITE).</p>
<p>Even for a toy problem, because I am using Bayesian estimation for the model parameters, the size of the output can get pretty large. Multiplied across 10 or 20 imputed datasets and you can see how the file sizes start to grow. In practice, I tend to save these outputs in a separate external hard drive, and load them when I need to do more extensive analyses.</p>
<h2 id="setting-up-the-model">Setting up the model:</h2>
<p>Here will run a simple model in which we predict the association between dispostional negativity and momentary positive affect, assuming a random intercept for individual&rsquo;s momentary positive mood ratings. For more context about the data and study design review the previous posts (linked above).</p>
<p>First the basic model assuming a Gaussian prior for the outcome distribution.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">PosAff_DN_form <span style="color:#f92672">&lt;-</span> 
  <span style="color:#a6e22e">brmsformula</span>(
    PosAff <span style="color:#f92672">~</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> c.DN <span style="color:#f92672">+</span> c.Best <span style="color:#f92672">+</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> c.Best<span style="color:#f92672">|</span>ID)
  ) <span style="color:#f92672">+</span> <span style="color:#a6e22e">gaussian</span>()
</code></pre></div><p>If you are familiar with <code>lme4</code> syntax (CITE + and link), this should model formulation should be fairly recognizable. We can translate this back to the underlying mathematical formulation. But first a quick conceptual overview of the model. At the between-subjects level, we have an effect that captures the association between individual dispostional negativity scores and average levels of momentary positive effect. At the momentary level, there is a component of the model that characterizes the association between ratings of recent positive events and momentary positive mood.</p>
<p>Now for the model.</p>
<h2 id="within-subjects-portion-of-the-model">Within-Subjects Portion of the Model</h2>
<p>$$
PosAff_{ti} \sim Normal(\pi_{0i} + \pi_{1i}(PosEvnt_{ti}-\bar{PosEvnt_{i}}), \sigma_{ti})
$$</p>
<h2 id="between-subjects-portion-of-the-model">Between-Subjects Portion of the Model</h2>
<p>$$
<code>\begin{equation} \begin{bmatrix} \pi_{0i} \\ \pi_{1i} \end{bmatrix} \sim Normal \Big( \begin{bmatrix} \beta_{00} + \beta_{01}(DN_i) \\ \beta_{10} \end{bmatrix} , \Sigma \Big) \end{equation}</code>
$$
where the <code>\(\beta\)</code>s represent the &ldquo;fixed&rdquo; or population effects in the model.</p>
<h2 id="references">References</h2>

                        </div>
                        
                        

                    </div>
                    

                    

                    

                    <div class="col-md-3">

                        

                        

<div class="panel panel-default sidebar-menu">

    <div class="panel-heading">
      <h3 class="panel-title">Search</h3>
    </div>

    <div class="panel-body">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" role="search">
            <div class="input-group">
                <input type="search" name="q" class="form-control" placeholder="Search">
                <input type="hidden" name="sitesearch" value="/">
                <span class="input-group-btn">
                    <button type="submit" class="btn btn-template-main"><i class="fas fa-search"></i></button>
                </span>
            </div>
        </form>
    </div>
</div>







<div class="panel panel-default sidebar-menu">

    <div class="panel-heading">
        <h3 class="panel-title">Categories</h3>
    </div>

    <div class="panel-body">
        <ul class="nav nav-pills nav-stacked">
            
            
            <li>
                <a href="/categories/ibi-vizedit">ibi-vizedit (1)</a>
            </li>
            
            <li>
                <a href="/categories/machine-learning">machine-learning (2)</a>
            </li>
            
            <li>
                <a href="/categories/modeling">modeling (9)</a>
            </li>
            
            <li>
                <a href="/categories/rshiny">rshiny (1)</a>
            </li>
            
        </ul>
    </div>

</div>








<div class="panel sidebar-menu">

    <div class="panel-heading">
        <h3 class="panel-title">Tags</h3>
    </div>

    <div class="panel-body">
        <ul class="tag-cloud">
            
            
            <li>
                <a href="/tags/ai"><i class="fas fa-tags"></i> ai</a>
            </li>
            
            <li>
                <a href="/tags/bayesian"><i class="fas fa-tags"></i> bayesian</a>
            </li>
            
            <li>
                <a href="/tags/data-processing"><i class="fas fa-tags"></i> data-processing</a>
            </li>
            
            <li>
                <a href="/tags/data-visualization"><i class="fas fa-tags"></i> data-visualization</a>
            </li>
            
            <li>
                <a href="/tags/forecasting"><i class="fas fa-tags"></i> forecasting</a>
            </li>
            
            <li>
                <a href="/tags/gaussian-process"><i class="fas fa-tags"></i> gaussian-process</a>
            </li>
            
            <li>
                <a href="/tags/lavaan"><i class="fas fa-tags"></i> lavaan</a>
            </li>
            
            <li>
                <a href="/tags/missing-data"><i class="fas fa-tags"></i> missing-data</a>
            </li>
            
            <li>
                <a href="/tags/ml"><i class="fas fa-tags"></i> ml</a>
            </li>
            
            <li>
                <a href="/tags/predictive-modeling"><i class="fas fa-tags"></i> predictive-modeling</a>
            </li>
            
            <li>
                <a href="/tags/r"><i class="fas fa-tags"></i> r</a>
            </li>
            
            <li>
                <a href="/tags/simulation"><i class="fas fa-tags"></i> simulation</a>
            </li>
            
            <li>
                <a href="/tags/stan"><i class="fas fa-tags"></i> stan</a>
            </li>
            
        </ul>
    </div>

</div>






                        

                    </div>
                    

                    

                </div>
                

            </div>
            
        </div>
        

        <footer id="footer">
    <div class="container">

        
        <div class="col-md-4 col-sm-6">
            <h4>About us</h4>

            <p>Consulting company specializing in the design of open source data processing and analytics pipelines.</p>

            <hr class="hidden-md hidden-lg hidden-sm">

        </div>
        
        

        <div class="col-md-4 col-sm-6">

             
            <h4>Recent posts</h4>

            <div class="blog-entries">
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="/blog/2020/04/15/2020-04-15-bayesian-multilevel-model-with-missing-data-complete-workflow-part-3-of-3/">
                          
                            <img src="/img/placeholder.png" class="img-responsive" alt="Bayesian Multilevel Model with Missing Data Complete Workflow (Part 3 of 3)">
                          
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="/blog/2020/04/15/2020-04-15-bayesian-multilevel-model-with-missing-data-complete-workflow-part-3-of-3/">Bayesian Multilevel Model with Missing Data Complete Workflow (Part 3 of 3)</a></h5>
                    </div>
                </div>
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="/blog/2019/01/19/2019-01-19-visualizing-variance-in-multilevel-models-using-the-riverplot-package/">
                          
                            <img src="/img/banners/riverplot.png" class="img-responsive" alt="Visualizing Variance in Multilevel Models Using the Riverplot Package">
                          
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="/blog/2019/01/19/2019-01-19-visualizing-variance-in-multilevel-models-using-the-riverplot-package/">Visualizing Variance in Multilevel Models Using the Riverplot Package</a></h5>
                    </div>
                </div>
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="/blog/2018/12/03/2018-12-03-a-rose-by-any-other-name-statistics-machine-learning-and-ai-part-2-of-3/">
                          
                            <img src="/img/banners/ml-vs-stats-pt2.png" class="img-responsive" alt="A Rose by Any Other Name: Statistics, Machine Learning, and AI (Part 2 of 3)">
                          
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="/blog/2018/12/03/2018-12-03-a-rose-by-any-other-name-statistics-machine-learning-and-ai-part-2-of-3/">A Rose by Any Other Name: Statistics, Machine Learning, and AI (Part 2 of 3)</a></h5>
                    </div>
                </div>
                
            </div>

            <hr class="hidden-md hidden-lg">
             

        </div>
        

        
        <div class="col-md-4 col-sm-6">

          <h4>Contact</h4>

            <p class="text-uppercase"><strong>Dead Reckoning Analytics & Consulting</strong>
        <br>PO Box 194
        <br>College Park, MD 20740
        <strong>United States</strong>
      </p>
      

            <a href="/contact" class="btn btn-small btn-template-main">Go to contact page</a>

            <hr class="hidden-md hidden-lg hidden-sm">

        </div>
        
        

    </div>
    
</footer>







<div id="copyright">
    <div class="container">
        <div class="col-md-12">
            
            <p class="pull-left">Copyright (c) 2020, Dead Reckoning Analytics & Consulting, LLC; all rights reserved.</p>
            
            <p class="pull-right">
              Template by <a href="https://bootstrapious.com/p/universal-business-e-commerce-template">Bootstrapious</a>.
              

              Ported to Hugo by <a href="https://github.com/devcows/hugo-universal-theme">DevCows</a>.
            </p>
        </div>
    </div>
</div>





    </div>
    

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-130198222-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

<script src="//code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0/jquery.counterup.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-parallax/1.1.3/jquery-parallax.js"></script>

<script src="//maps.googleapis.com/maps/api/js?v=3.exp"></script>

<script src="/js/hpneo.gmaps.js"></script>
<script src="/js/gmaps.init.js"></script>
<script src="/js/front.js"></script>


<script src="/js/owl.carousel.min.js"></script>



  </body>
</html>
