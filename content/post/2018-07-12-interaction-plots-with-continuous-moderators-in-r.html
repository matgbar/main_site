---
title: "Interaction Plots with Continuous Moderators in R"
author: "Matthew Barstead"
date: '2018-07-11'
header:
  caption: ''
  image: ''
slug: interaction-plots-with-continuous-moderators-in-r
tags:
- R
- Data Vizualization
- Plotting
- Structural Equation Modeling
- lavaan
categories: Data Vizualization
---



<p>Long ago (the first half of my grad school life), I created a model for a manuscript I submitted. The paper was focused on adolescents’ appraisals of their relationships with their mothers, fathers, and best friends. Specifically, I wanted to test whether the association between different motivations for social withdrawal (i.e., removing oneself from social activities and interactions) and internalizing symptoms varied as a function of perceived support in any one (or all three) of these relationships.</p>
<p>It is and was a modest study, with some flaws (notably the fact I only had self-report measures from the adolescents). If you want more context for the rest of this post, you can read the paper <a href="https://mgb-research.netlify.com/publication/barstead_etal_2017_jora/">here</a>. These data come from the <em>Friendship Project</em> and were collected in the early-to-mid 2000s, a fact that I wish I had included in the manuscript in retrospect. My blog is as good a place as any to call out my past transparency shortcomings I suppose.</p>
<p>To understand the data and models, here is some additional information:</p>
<ol style="list-style-type: decimal">
<li><p>I had grade 8 measures of relationship quality, shyness, preference for solitude, and anxiety/depression</p></li>
<li><p>I had grade 9 measures of anxiety and depression</p></li>
<li><p>The analyses were based on a saturated path model in <code>lavaan</code> - an R package for creating and testing structural equation models.</p></li>
</ol>
<p>Using <code>lavaan</code> (<strong>la</strong>tent <strong>va</strong>riable <strong>an</strong>alysis), I created three latent variables that represented outcomes of interest in grade 9: anxiety, depression, and general negative affect (I refer to this as dispositional negativity in the manuscript). To start, here is the model:</p>
<pre class="r"><code>mod8&lt;-&#39;
int=~cdi9ngmd+cdi9inpr+cdi9inef+cdi9anhe+cdi9ngse+masc9tr+masc9sma+masc9per+masc9ac+masc9hr+masc9pf
dep=~cdi9ngmd+cdi9inpr+cdi9inef+cdi9anhe+cdi9ngse
anx=~masc9tr+masc9sma+masc9per+masc9ac+masc9hr+masc9pf
int~ysr8anxd+sex1+c.pfs+c.shy+
c.mospt+mopstXpfs+mopstXshy+
c.faspt+
c.frspt
dep~ysr8anxd+sex1+c.pfs+c.shy+
c.mospt+mopstXpfs+mopstXshy+
c.faspt+
c.frspt+frsptXpfs+frsptXshy
anx~ysr8anxd+sex1+c.pfs+c.shy+
c.mospt+mopstXpfs+mopstXshy+
c.faspt+
c.frspt
#Covariances
int~~0*dep
int~~0*anx
anx~~0*dep
#Added covariances 
masc9hr ~~ masc9pf
cdi9inpr ~~ masc9per
cdi9inef ~~  masc9ac 
&#39;

fit8&lt;-sem(mod8, data=dat, std.lv = T, estimator = &#39;MLR&#39;)
summary(fit8, fit.measures=T)</code></pre>
<p>Now there is a whole script file of assumption checking and model evaluation that goes along with this (that is how I got to model 8). I have just included the final model here for simplicity’s sake.</p>
<p>One thing that frustrates me when we report on interactions between variables is that we often pick static, potentially arbitrary values to probe simple slopes. A common pair of values is +/- 1 <em>SD</em>. Sometimes researchers will also examine simple slopes at the mean of the sample as well. Probing simple slopes at static values also influences how researchers present their findings visually. Typically, we get either a pair of bars or lines to use to help us better evaluate the nature of the detected interaction.</p>
<p>Here is where my gripe starts to eek in. Why are we probing simple slopes at static (often arbitrary) values? When our moderators are continuous it seems to me the better approach is to evaluate and interpret the effect of the moderator on the association between <code>X</code> and <code>Y</code> along the entire continuum of plausible moderator values.</p>
<p>To do this, I need to extract some information from my model first. I’ll need the point estimates and their variances invovled in defining the moderation:</p>
<pre class="r"><code>parm&lt;-as.data.frame(parameterEstimates(fit))
parm[,1:3]

COV&lt;-vcov(fit)
COVd&lt;-as.data.frame(COV)</code></pre>
<p>Okay so now that I have the information, I can grab the relevant values as follows. (You don’t need to grab things from the model using R objects - you can type in values manually here instead should you wish).</p>
<pre class="r"><code>b1&lt;-parm[26,4]#slope for SHY
b3&lt;-parm[28,4]#slope for SHY x Maternal Support
s11&lt;-COV[26,26]#variance for SHY
s13&lt;-COV[26,28]#covariance for SHY and SHY x Maternal Support
s33&lt;-COV[28,28]#variance for SHY x MS Parameter</code></pre>
<p>I then need to create a vector of values that I am going to use for plotting. Since the long-standing convention has been to use standardized values of the moderator for probing simple slopes, I keep with that tradition in the code below.</p>
<pre class="r"><code>sd1&lt;-c(-2, -1.75, -1.5, -1.25, -1, -.75, -.5, -.25, 0,
       .25,.5,.75,1,1.25,1.5,1.75,2)

sd2&lt;-sd1*sd(data$c.mospt)

#Formula for standard error of simple slopes can be found in most regression textbooks 
se&lt;-sqrt(s11+2*(sd2)*s13+(sd2)*(sd2)*s33)
se

b1&lt;-b1+b3*(sd2)

b1
UB&lt;-b1+se*qnorm(.975)
LB&lt;-b1+se*qnorm(.025)

jpeg(&quot;SHYxMS predicting DN.jpeg&quot;, res=300, width = 9, height=6, units = &quot;in&quot;)
plot(b1~sd1, type=&quot;n&quot;, ylim=c(-2, 2), xlim=c(-2, 2), 
     xlab=&quot;Standardized Maternal Support&quot;, ylab=&quot;Shyness Slope&quot;, 
     main=&quot;Relation betweeen Shyness and Dispositional Negativity 
     as a Function of Maternal Support&quot;, 
     cex.lab=1.5, cex.main=1.9)
polygon(c(rev(sd1), sd1), c(rev(UB), LB), col=&quot;grey80&quot;, border=NA)
lines(b1~sd1, type=&quot;l&quot;, lwd=4)
lines(UB~sd1, lty=&quot;dashed&quot;, col=&quot;red&quot;, lwd=2)
lines(LB~sd1, lty=&quot;dashed&quot;, col=&quot;red&quot;, lwd=2)
abline(a=0, b=0, lty=&quot;dotted&quot;, col=&quot;black&quot;, lwd=3)
dev.off()</code></pre>
<p>And voila! To me, the greatest value of this approach is that I can see exactly where 0 is included in the 95% confidence band and where the value falls outside the confidence band. For instance, in the plot below, I can easily see that the model would only predict a significant and positive association between shyness and dispositional negativity for adolescents with lower levels of self-reported maternal relationship quality.</p>
<div class="figure">
<img src="img/Barstead_etal_Jora2017_fig4.jpg" />

</div>
<p>Note that you may have to change the y-axis scaling to get the plot to display correctly. Otherwise, you now never have to ever ever plot the interaction between two continuous variables using a pair of static variables.</p>
